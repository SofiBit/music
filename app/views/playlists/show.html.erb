<% if current_user == @playlist.user %>
  <div id="button-public-private-track">
    <% if @playlist.private? %>
      <button onclick="makePublic(<%= @playlist.id %>)">Make public</button>
    <% else %>
      <button onclick="makePrivate(<%= @playlist.id %>)">Make private</button>
    <% end %>
  </div>
<% end %>

<%= render 'tracks' %>

<% unless current_user == @playlist.user %>
  <% if current_user.playlists_by_friends.include?(@playlist)%>
    <div id="button_playlist">
      <%= render 'playlist_subscriptions/create' %>
    </div>
  <% else %>
    <div id="button_playlist">
      <%= render 'playlist_subscriptions/destroy' %>
    </div>
  <% end %>
<% end %>

<div class ="all-comments">
  <div id="comments">
    <% @playlist.comments.reverse.each do |comment| %>
      <div class="comment"><%= user_name(comment.user) %> : <%= comment.body %></div>
      <div id="reply-on-comment" onclick="newComment(<%= comment.id %>, '<%= comment.class %>')">Reply</div>

      <div class="nested-comments">
        <div id="comments-on-comment-<%= comment.id %>">
          <% comment.comments.reverse.each do |comment| %>
            <div class="comment"><%= user_name(comment.user) %> : <%= comment.body %></div>
            <hr>
          <% end %>
        </div>
        <div id="new-comment-<%= comment.id %>"></div>
      </div>
      <hr>
    <% end %>
  </div>
  <div id="new-comment">
    <%= form_with model: @playlist.comments.new, id: 'comment-form' do |form| %>
      <%= form.text_area :body, id: 'txtarea', spellchek: false %>

      <%= form.hidden_field :user_id, value: current_user.id %>

      <%= form.hidden_field :object_id, value: @playlist.id %>

      <%= form.hidden_field :object_type, value: @playlist.class %>

      <%= submit_tag(t('input.send'), class: "btn btn-outline-secondary") %>
    <% end %>
  </div>
</div>

<script>
  textarea();
</script>
